parts = 100;xbounds = [0 10];ybounds = [0 4];xdata = rand(parts, 1) .* xbounds(2);ydata = zeros(parts, 1);xgrid = 0.01;ygrid = 0.01;figurehandle = scatter(xdata, ydata, 'filled');xlim(xbounds);ylim(ybounds);for t = 1:10000    p = 0.8;    for i = [1:parts]        dx = ((rand > p) - 0.5) * 2;        dy = ((rand > p) - 0.5) * 2;            xdata(i) = xdata(i) + dx*xgrid;        %these two lines assure the molecules stays in x bounds        xdata(find(xdata < xbounds(1))) = xbounds(1);        xdata(find(xdata > xbounds(2))) = xbounds(2);                ydata(i) = ydata(i) + dy*ygrid;        %these two lines assure the molecule stays in y bound        ydata(find(ydata < ybounds(1))) = ybounds(1);        ydata(find(ydata > ybounds(2))) = ybounds(2);    endfor            set(handle, 'xdata', xdata, 'ydata', ydata);    drawnow;endfor    