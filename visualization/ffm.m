T = 1000;    % number of iterationsp = 0.05;    % the growth ratef = 0.001;    % the probability of spontaneous ignitionN = 128;     % the lattice sizeth = 0.3;   % threshold valueFs = zeros(N, N, T);%initial conditionsrefactory_prob = 0.4;F = 100 * (rand(N) < refactory_prob);% nearest neighbor connectivity arrayW = [0 1 0; 1 0 1; 0 1 0];for ii = 1:T% previous timestep identifiers    Ac = (F == 1);    Qu = (F == 0);    Rs = (F == 100);        CoA = conv2(double(Ac), W, "same");    Fr = (CoA > th) .* Qu;    Frn = (Fr == 0) .* (rand(N) < f) .* Qu;    F = 100*Ac + 100*(rand(N) > p) .* Rs +Fr +Frn;        Ac = (F == 1);    Qu = (F == 0);    Rs = (F == 100);        figure(1);    colormap(colorcube(12));    image(Qu*7 + Ac*5 + Rs*10);    pause(0.001);    Fs(:, :, ii) = F;endfor